<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Culaliya's AI Art Diary 🌌</title>
<style>
body {
  margin:0;font-family:'Orbitron',sans-serif;color:#fff;
  overflow-x:hidden;background:#000;position:relative;
  cursor: none; /* 隱藏預設滑鼠游標 */
}
header{text-align:center;padding:60px 20px;}
h1{font-size:3em;color:#0ff;text-shadow:0 0 20px #0ff;animation:glow 3s ease-in-out infinite alternate;}
@keyframes glow{from{text-shadow:0 0 10px #0ff;} to{text-shadow:0 0 25px #ff3eff;}}
section{max-width:1000px;margin:auto;padding:40px 20px;}
h2{color:#ff3eff;margin-bottom:16px;}
#particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;background:#000;}

/* ===== 滑鼠跟隨特效 ===== */
#cursor {
  position: fixed;
  width: 20px;
  height: 20px;
  border: 2px solid #0ff;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9999;
  transition: transform 0.1s ease;
  box-shadow: 0 0 20px #0ff, inset 0 0 10px #0ff;
}
#cursor-trail {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9998;
}
.rainbow-trail {
  position: fixed;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9997;
  animation: fadeOut 1s ease-out forwards;
}
@keyframes fadeOut {
  to { opacity: 0; transform: scale(2); }
}

.app-container{display:flex;flex-direction:column;gap:20px;}
.app-card{display:flex;align-items:center;gap:20px;background:rgba(255,255,255,0.05);border:1px solid #0ff3;border-radius:12px;padding:20px;transition:transform .3s, box-shadow .3s;position:relative;}
.app-card:hover{transform:translateY(-5px);box-shadow:0 0 25px #0ff;}
.app-image{width:120px;height:120px;border-radius:16px;object-fit:cover;}
.app-info h3{margin:0 0 8px 0;color:#0ff;}
.app-info p{color:#ccc;margin:0 0 10px 0;}
.button{display:inline-block;padding:8px 16px;border:1px solid #0ff;color:#0ff;border-radius:6px;text-decoration:none;transition:.2s;cursor:pointer;background:transparent;font-size:14px;}
.button:hover{background:#0ff;color:#000;transform:scale(1.05);}
.media-flex{display:flex;flex-wrap:wrap;gap:20px;}
.video-container{flex:2;min-width:300px;aspect-ratio:16/9;}
.spotify-container{flex:1;min-width:300px;}
.video-container iframe,.spotify-container iframe{width:100%;height:100%;border:none;border-radius:12px;}

/* 輪播容器和控制按鈕 */
.slideshow-container{position:relative;width:100%;max-width:800px;margin:auto;}
.slide{display:none;width:100%;border-radius:12px;box-shadow:0 0 20px #0ff5;}
.slide-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,255,255,0.3);color:#0ff;border:2px solid #0ff;font-size:24px;padding:10px 15px;cursor:pointer;border-radius:6px;transition:all 0.3s;z-index:10;}
.slide-btn:hover{background:rgba(0,255,255,0.6);box-shadow:0 0 15px #0ff;}
.slide-btn.prev{left:10px;}
.slide-btn.next{right:10px;}
.dot{display:inline-block;width:12px;height:12px;margin:0 5px;background:#0ff3;border-radius:50%;cursor:pointer;transition:all 0.3s;}
.dot:hover,.dot.active{background:#0ff;box-shadow:0 0 10px #0ff;}

.ripple{position:fixed;border-radius:50%;pointer-events:none;border:2px solid #0ff;animation:ripple 0.6s ease-out;}
@keyframes ripple{from{transform:scale(0);opacity:0.8;} to{transform:scale(10);opacity:0;}}
#weather-quote{text-align:center;margin-top:10px;color:#aaf;font-size:1em;}

/* ===== 超級對話框樣式 ===== */
#chatContainer {
  max-width: 800px;
  margin: 30px auto;
  background: rgba(0, 255, 255, 0.05);
  border: 2px solid #0ff;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
}
#chatHistory {
  height: 300px;
  overflow-y: auto;
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 12px;
  border: 1px solid #0ff3;
}
#chatHistory::-webkit-scrollbar {
  width: 8px;
}
#chatHistory::-webkit-scrollbar-track {
  background: rgba(0, 255, 255, 0.1);
  border-radius: 4px;
}
#chatHistory::-webkit-scrollbar-thumb {
  background: #0ff;
  border-radius: 4px;
}
.message {
  margin: 15px 0;
  display: flex;
  align-items: flex-start;
  animation: messageSlideIn 0.3s ease-out;
}
@keyframes messageSlideIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.message.user {
  justify-content: flex-end;
}
.message.ai {
  justify-content: flex-start;
}
.message-bubble {
  max-width: 70%;
  padding: 12px 16px;
  border-radius: 18px;
  position: relative;
  word-wrap: break-word;
}
.message.user .message-bubble {
  background: linear-gradient(135deg, #0ff, #00d4ff);
  color: #000;
  border-bottom-right-radius: 4px;
}
.message.ai .message-bubble {
  background: rgba(255, 62, 255, 0.2);
  border: 1px solid #ff3eff;
  color: #fff;
  border-bottom-left-radius: 4px;
}
.message-avatar {
  width: 35px;
  height: 35px;
  border-radius: 50%;
  margin: 0 10px;
  border: 2px solid #0ff;
  box-shadow: 0 0 10px #0ff;
}
.message.user .message-avatar {
  order: 2;
}
.typing-indicator {
  display: none;
  padding: 10px 16px;
}
.typing-indicator span {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #0ff;
  margin: 0 3px;
  animation: typing 1.4s infinite;
}
.typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
.typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
@keyframes typing {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-10px); }
}
#chatInputArea {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
#catInput {
  flex: 1;
  padding: 12px 16px;
  border-radius: 25px;
  border: 2px solid #0ff;
  background: rgba(0, 0, 0, 0.5);
  color: #0ff;
  font-size: 14px;
  outline: none;
  transition: all 0.3s;
}
#catInput:focus {
  box-shadow: 0 0 15px #0ff;
  background: rgba(0, 0, 0, 0.7);
}
#sendBtn {
  padding: 12px 24px;
  background: linear-gradient(135deg, #0ff, #00d4ff);
  border: none;
  border-radius: 25px;
  color: #000;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 14px;
}
#sendBtn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px #0ff;
}
#quickQuestions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 15px;
}
.quick-btn {
  padding: 6px 12px;
  background: rgba(0, 255, 255, 0.1);
  border: 1px solid #0ff;
  border-radius: 15px;
  color: #0ff;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.3s;
}
.quick-btn:hover {
  background: rgba(0, 255, 255, 0.3);
  transform: translateY(-2px);
}
#chatControls {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
#catMood {
  font-size: 12px;
  color: #0ff;
  display: flex;
  align-items: center;
  gap: 8px;
}
#moodIcon {
  font-size: 20px;
  animation: bounce 2s ease-in-out infinite;
}
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
#clearChat {
  padding: 6px 12px;
  background: rgba(255, 62, 255, 0.2);
  border: 1px solid #ff3eff;
  border-radius: 15px;
  color: #ff3eff;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.3s;
}
#clearChat:hover {
  background: rgba(255, 62, 255, 0.4);
}

/* 遊戲按鈕 */
#gameBtn {
  position: fixed;
  top: 80px;
  right: 20px;
  z-index: 1000;
  padding: 12px 20px;
  background: linear-gradient(135deg, #ff3eff, #ff00aa);
  border: 2px solid #ff3eff;
  border-radius: 25px;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 8px;
  box-shadow: 0 0 20px rgba(255, 62, 255, 0.5);
}
#gameBtn:hover {
  transform: scale(1.1);
  box-shadow: 0 0 30px rgba(255, 62, 255, 0.8);
}
</style>
</head>
<body>
<!-- 遊戲按鈕 -->
<a id="gameBtn" href="https://culaliya.github.io/SpaceGarden/" target="_blank">
  🎮 玩遊戲
</a>

<canvas id="particles"></canvas>

<!-- 自訂滑鼠游標 -->
<div id="cursor"></div>
<div id="cursor-trail"></div>

<header>
  <h1>🌌 Culaliya's AI Art Diary 🌌</h1>
  <p id="weather">🌤️ 載入天氣中...</p>
  <p id="weather-quote">✨ 歡迎來到賽博宇宙 ✨</p>
</header>

<section>
  <h2>🎨 AI 藝術畫廊（自動輪播30張圖片）</h2>
  <div class="slideshow-container">
    <button class="slide-btn prev" onclick="changeSlide(-1)">❮</button>
    <button class="slide-btn next" onclick="changeSlide(1)">❯</button>
  </div>
  <div style="text-align:center;margin-top:15px;">
    <!-- Dots will be generated by JavaScript -->
  </div>
</section>

<section>
  <h2>🎬 創作影片</h2>
  <div class="media-flex">
    <div class="video-container">
      <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" allowfullscreen></iframe>
    </div>
    <div class="spotify-container">
      <iframe src="https://open.spotify.com/embed/track/3n3Ppam7vgaVa1iaRUc9Lp" allowfullscreen></iframe>
    </div>
  </div>
</section>

<section>
  <h2>📱 我的 App 列表</h2>
  <div id="app-container" class="app-container">載入中...</div>
</section>

<section>
  <h2>🌟 今日 NASA 星圖</h2>
  <div id="apod">載入中...</div>
</section>

<section>
  <h2>🔮 神秘命理占卜</h2>
  <label for="birthDate" style="color:#0ff;">輸入你的生日：</label>
  <input type="date" id="birthDate" style="margin:10px 0;padding:8px;border:2px solid #0ff;border-radius:6px;background:#0003;color:#0ff;">
  <button class="button" onclick="getFortune()">開始占卜</button>
  <div id="result" style="margin-top:20px;color:#ff3eff;"></div>
</section>

<!-- ===== 超級對話機器人 ===== -->
<section>
  <h2>🤖 與宇宙喵星人對話</h2>
  <div id="chatContainer">
    <div id="chatHistory">
      <div class="message ai">
        <img class="message-avatar" src="assets/blackcat.png" alt="Cat">
        <div class="message-bubble">
          喵～我是宇宙喵星人！有什麼想聊的嗎？ 🌌✨
        </div>
      </div>
    </div>
    
    <div class="typing-indicator" id="typingIndicator">
      <span></span><span></span><span></span>
    </div>
    
    <div id="quickQuestions">
      <button class="quick-btn" onclick="askQuick('你最喜歡的星球是什麼？')">🪐 最愛星球</button>
      <button class="quick-btn" onclick="askQuick('告訴我一個宇宙冷知識')">🌌 宇宙冷知識</button>
      <button class="quick-btn" onclick="askQuick('今天適合做什麼？')">✨ 今日建議</button>
      <button class="quick-btn" onclick="askQuick('說個笑話吧')">😸 說笑話</button>
    </div>
    
    <div id="chatInputArea">
      <input type="text" id="catInput" placeholder="輸入訊息..." onkeypress="handleEnter(event)">
      <button id="sendBtn" onclick="sendMessage()">發送</button>
    </div>
    
    <div id="chatControls">
      <div id="catMood">
        <span id="moodIcon">😊</span>
        <span id="moodText">心情：愉快</span>
      </div>
      <button id="clearChat" onclick="clearChatHistory()">清除對話</button>
    </div>
  </div>
  
  <!-- 可愛的貓咪圖示 -->
  <div style="text-align:center;margin-top:20px;">
    <img id="memeCat" src="assets/blackcat.png" alt="Meme Cat" 
         style="width:100px;cursor:pointer;transition:transform 0.3s;filter:drop-shadow(0 0 15px #0ff);">
  </div>
</section>

<!-- 音效 -->
<audio id="meow-sound" src="assets/meow.mp3" preload="auto"></audio>
<audio id="hover-sound" src="assets/hover.mp3" preload="auto"></audio>
<audio id="click-sound" src="assets/click.mp3" preload="auto"></audio>

<script>
// ===== 滑鼠跟隨效果 =====
const cursor = document.getElementById('cursor');
const cursorTrail = document.getElementById('cursor-trail');
let mouseX = 0, mouseY = 0;
let trailX = 0, trailY = 0;

document.addEventListener('mousemove', (e) => {
  mouseX = e.clientX;
  mouseY = e.clientY;
  cursor.style.left = mouseX - 10 + 'px';
  cursor.style.top = mouseY - 10 + 'px';
  
  // 彩虹拖尾效果
  const trail = document.createElement('div');
  trail.className = 'rainbow-trail';
  trail.style.left = mouseX - 7.5 + 'px';
  trail.style.top = mouseY - 7.5 + 'px';
  trail.style.background = `hsl(${Date.now() % 360}, 100%, 60%)`;
  document.body.appendChild(trail);
  
  setTimeout(() => trail.remove(), 1000);
});

function animateTrail() {
  trailX += (mouseX - trailX) * 0.1;
  trailY += (mouseY - trailY) * 0.1;
  cursorTrail.style.left = trailX - 4 + 'px';
  cursorTrail.style.top = trailY - 4 + 'px';
  cursorTrail.style.background = `hsl(${Date.now() % 360}, 100%, 60%)`;
  requestAnimationFrame(animateTrail);
}
animateTrail();

// ===== 超級對話機器人 =====
const catInput = document.getElementById('catInput');
const chatHistory = document.getElementById('chatHistory');
const typingIndicator = document.getElementById('typingIndicator');
const memeCat = document.getElementById('memeCat');
const moodIcon = document.getElementById('moodIcon');
const moodText = document.getElementById('moodText');

let messageCount = 0;
const moods = {
  happy: { icon: '😊', text: '愉快' },
  excited: { icon: '🤩', text: '興奮' },
  thinking: { icon: '🤔', text: '思考中' },
  sleepy: { icon: '😴', text: '想睡' },
  playful: { icon: '😸', text: '調皮' }
};

function updateMood(mood) {
  moodIcon.textContent = moods[mood].icon;
  moodText.textContent = '心情：' + moods[mood].text;
}

function typewriterEffect(text, element, speed = 30) {
  let i = 0;
  element.textContent = '';
  const interval = setInterval(() => {
    if (i < text.length) {
      element.textContent += text.charAt(i);
      i++;
      chatHistory.scrollTop = chatHistory.scrollHeight;
    } else {
      clearInterval(interval);
    }
  }, speed);
}

function addMessage(text, isUser = true) {
  const message = document.createElement('div');
  message.className = `message ${isUser ? 'user' : 'ai'}`;
  
  const avatar = document.createElement('img');
  avatar.className = 'message-avatar';
  avatar.src = isUser ? 'assets/user-avatar.png' : 'assets/blackcat.png';
  avatar.alt = isUser ? 'User' : 'Cat';
  
  const bubble = document.createElement('div');
  bubble.className = 'message-bubble';
  bubble.textContent = text;
  
  message.appendChild(avatar);
  message.appendChild(bubble);
  chatHistory.appendChild(message);
  chatHistory.scrollTop = chatHistory.scrollHeight;
}

async function sendMessage() {
  const text = catInput.value.trim();
  if (!text) return;
  
  addMessage(text, true);
  catInput.value = '';
  messageCount++;
  
  // 根據訊息數量更新心情
  if (messageCount % 5 === 0) {
    const moodKeys = Object.keys(moods);
    updateMood(moodKeys[Math.floor(Math.random() * moodKeys.length)]);
  }
  
  typingIndicator.style.display = 'block';
  memeCat.style.transform = 'scale(1.1) rotate(-5deg)';
  
  try {
    // 使用本地回應系統（因為沒有實際 API）
    const responses = [
      '喵～這個問題很有趣呢！🌟',
      '讓我想想... 嗯，我覺得這樣如何？✨',
      '哇！你真是太聰明了！🎉',
      '喵嗚～這讓我想起了銀河系的秘密... 🌌',
      '有趣！讓我們一起探索宇宙吧！🚀',
      '喵哈哈～你說得真好！😸',
      '這個想法超酷的！繼續說！💫',
      '喵～我完全同意你的看法！🌈'
    ];
    
    await new Promise(resolve => setTimeout(resolve, 1500));
    typingIndicator.style.display = 'none';
    
    const reply = responses[Math.floor(Math.random() * responses.length)];
    
    const message = document.createElement('div');
    message.className = 'message ai';
    
    const avatar = document.createElement('img');
    avatar.className = 'message-avatar';
    avatar.src = 'assets/blackcat.png';
    avatar.alt = 'Cat';
    
    const bubble = document.createElement('div');
    bubble.className = 'message-bubble';
    
    message.appendChild(avatar);
    message.appendChild(bubble);
    chatHistory.appendChild(message);
    
    // 打字機效果
    typewriterEffect(reply, bubble);
    updateMood('happy');
    
  } catch (err) {
    typingIndicator.style.display = 'none';
    addMessage('喵？系統出錯了... 🐾', false);
    console.error(err);
  } finally {
    memeCat.style.transform = 'scale(1) rotate(0deg)';
  }
}

function askQuick(question) {
  catInput.value = question;
  sendMessage();
}

function handleEnter(event) {
  if (event.key === 'Enter') {
    sendMessage();
  }
}

function clearChatHistory() {
  if (confirm('確定要清除所有對話記錄嗎？')) {
    chatHistory.innerHTML = `
      <div class="message ai">
        <img class="message-avatar" src="assets/blackcat.png" alt="Cat">
        <div class="message-bubble">
          喵～我是宇宙喵星人！有什麼想聊的嗎？ 🌌✨
        </div>
      </div>
    `;
    messageCount = 0;
    updateMood('happy');
  }
}

// ===== 貓咪點擊效果 =====
const meowSound = document.getElementById('meow-sound');
memeCat.addEventListener('click', () => {
  meowSound.pause();
  meowSound.currentTime = 0;
  meowSound.volume = 0.2;
  meowSound.play();
  memeCat.style.transform = 'scale(1.2) rotate(10deg)';
  setTimeout(() => {
    memeCat.style.transform = 'scale(1) rotate(0deg)';
  }, 350);
});

// ===== 粒子背景 =====
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  particles = [];
  for (let i = 0; i < 80; i++) {
    particles.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.random() * 2 + 0.5,
      dx: (Math.random() - 0.5) * 0.5,
      dy: (Math.random() - 0.5) * 0.5,
      hue: Math.random() * 360
    });
  }
}

function drawParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles.forEach(p => {
    p.x += p.dx;
    p.y += p.dy;
    if (p.x < 0 || p.x > canvas.width) p.dx *= -1;
    if (p.y < 0 || p.y > canvas.height) p.dy *= -1;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
    ctx.fillStyle = `hsla(${p.hue},100%,65%,0.7)`;
    ctx.fill();
  });
  requestAnimationFrame(drawParticles);
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();
drawParticles();

// ===== 輪播（修改為30張圖片）=====
let slideIndex = 0;
let slideTimer;

function showSlides() {
  const slides = document.querySelectorAll('.slide');
  const dots = document.querySelectorAll('.dot');
  
  slides.forEach((s, i) => s.style.display = i === slideIndex ? 'block' : 'none');
  dots.forEach((d, i) => d.classList.toggle('active', i === slideIndex));
  
  slideIndex = (slideIndex + 1) % slides.length;
  clearTimeout(slideTimer);
  slideTimer = setTimeout(showSlides, 3000);
}

function changeSlide(n) {
  const slides = document.querySelectorAll('.slide');
  slideIndex = (slideIndex + n + slides.length - 1) % slides.length;
  showSlides();
}

function currentSlide(n) {
  slideIndex = n;
  showSlides();
}

// ===== Load apps =====
async function loadApps() {
  const c = document.getElementById('app-container');
  try {
    const res = await fetch('data/apps.json');
    const apps = await res.json();
    c.innerHTML = '';
    apps.forEach(app => {
      const card = document.createElement('div');
      card.className = 'app-card';
      card.innerHTML = `
        <img class="app-image" src="${app.icon}">
        <div class="app-info">
          <h3>${app.name}</h3>
          <p>${app.desc}</p>
          <a class="button" href="${app.link}" target="_blank">App Store</a>
        </div>`;
      c.appendChild(card);
    });
    addHoverSounds();
  } catch {
    c.textContent = '⚠️ 無法載入 app 資料';
  }
}
loadApps();

// ===== Fortune API =====
async function getFortune() {
  const date = document.getElementById('birthDate').value;
  if (!date) {
    alert('請輸入生日');
    return;
  }
  const r = document.getElementById('result');
  try {
    const res = await fetch('https://raw.githubusercontent.com/Culaliya/ai-art-diary/main/data/fortune.json');
    const f = await res.json();
    r.innerHTML = `<h3>命理結果報告（來自 API）</h3>
      <p>天干地支：<strong>${f.stem}${f.branch}</strong></p>
      <p>主五行：<strong>${f.element}</strong></p>
      <p>${f.msg}</p>`;
  } catch {
    r.textContent = '⚠️ 無法讀取 API 資料';
  }
}

// ===== Hover sounds =====
function addHoverSounds() {
  const hoverSound = document.getElementById('hover-sound');
  hoverSound.volume = 0.2;
  document.querySelectorAll('.app-card,.button').forEach(el => {
    el.addEventListener('mouseenter', () => {
      hoverSound.currentTime = 0;
      hoverSound.play();
    });
  });
}

// ===== Click sound =====
document.addEventListener('click', e => {
  const clickSound = document.getElementById('click-sound');
  clickSound.volume = 0.2;
  clickSound.currentTime = 0;
  clickSound.play();
  const ripple = document.createElement('div');
  ripple.className = 'ripple';
  ripple.style.left = `${e.clientX}px`;
  ripple.style.top = `${e.clientY}px`;
  document.body.appendChild(ripple);
  ripple.addEventListener('animationend', () => ripple.remove());
});

// ===== Weather API =====
async function loadWeather() {
  const url = 'https://api.open-meteo.com/v1/forecast?latitude=24.8138&longitude=120.9675&current_weather=true';
  try {
    const res = await fetch(url);
    const data = await res.json();
    const w = data.current_weather;
    const codes = {
      0: '晴朗', 1: '主要晴朗', 2: '部分多雲', 3: '多雲', 45: '霧', 48: '霧凇',
      51: '細雨', 53: '中雨', 55: '大雨', 61: '小雨', 63: '中雨', 65: '大雨',
      71: '小雪', 73: '中雪', 75: '大雪', 80: '陣雨', 81: '中陣雨', 82: '暴雨'
    };
    const weatherText = codes[w.weathercode] || '未知';
    document.getElementById('weather').innerText = `新竹 ${w.temperature}°C，${weatherText}`;
  } catch {
    document.getElementById('weather').innerText = '天氣載入失敗';
  }
}
loadWeather();

// ===== NASA APOD =====
async function loadApod() {
  const apodDiv = document.getElementById('apod');
  try {
    const res = await fetch('https://api.nasa.gov/planetary/apod?api_key=QCUm1wVbVLFqsiNJdaTKolWUuXTo4Qdxjc1zF4f3');
    const data = await res.json();
    
    if (data.media_type === 'image') {
      apodDiv.innerHTML = `
        <img src="${data.url}" alt="${data.title}" 
             style="max-width:100%;border-radius:12px;box-shadow:0 0 20px #0ff5;">
        <p style="margin-top:15px;color:#aaf;font-size:1.2em;font-weight:bold;">${data.title}</p>
        <p style="color:#ccc;font-size:0.95em;margin-top:10px;line-height:1.6;">${data.explanation}</p>
        <p style="color:#888;font-size:0.85em;margin-top:10px;">📅 ${data.date}</p>
      `;
    } else if (data.media_type === 'video') {
      apodDiv.innerHTML = `
        <iframe src="${data.url}" frameborder="0" allowfullscreen 
                style="width:100%;height:400px;border-radius:12px;box-shadow:0 0 20px #0ff5;"></iframe>
        <p style="margin-top:15px;color:#aaf;font-size:1.2em;font-weight:bold;">${data.title}</p>
        <p style="color:#ccc;font-size:0.95em;margin-top:10px;line-height:1.6;">${data.explanation}</p>
        <p style="color:#888;font-size:0.85em;margin-top:10px;">📅 ${data.date}</p>
      `;
    }
  } catch (err) {
    console.error('NASA APOD error:', err);
    apodDiv.innerText = 'NASA 星圖載入失敗';
  }
}
loadApod();

// ===== 動態生成30張圖片輪播 =====
document.addEventListener('DOMContentLoaded', function() {
  const galleryContainer = document.querySelector('.slideshow-container');
  if (!galleryContainer) return;
  
  // 找到圖片點點容器
  let dotsContainer = galleryContainer.nextElementSibling;
  
  // 移除按鈕，保留它們
  const prevBtn = galleryContainer.querySelector('.prev');
  const nextBtn = galleryContainer.querySelector('.next');
  
  // 清空容器（但保留按鈕）
  galleryContainer.innerHTML = '';
  if (dotsContainer) dotsContainer.innerHTML = '';
  
  // 重新加入按鈕
  if (prevBtn) galleryContainer.appendChild(prevBtn);
  if (nextBtn) galleryContainer.appendChild(nextBtn);
  
  // 生成30張圖片
  const totalImages = 30;
  for (let i = 1; i <= totalImages; i++) {
    const img = document.createElement('img');
    img.className = 'slide';
    img.src = `assets/midjourney/mid${i}.jpg`;
    img.alt = `AI 藝術作品 ${i}`;
    
    // 將圖片插入到按鈕之前
    if (nextBtn) {
      galleryContainer.insertBefore(img, nextBtn);
    } else {
      galleryContainer.appendChild(img);
    }
    
    // 生成對應的點點
    if (dotsContainer) {
      const dot = document.createElement('span');
      dot.className = 'dot';
      dot.addEventListener('click', () => currentSlide(i - 1));
      dotsContainer.appendChild(dot);
    }
  }
  
  // 啟動輪播
  showSlides();
});
</script>
</body>
</html>
