<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Culaliya's AI Art Diary ğŸŒŒ</title>
<style>
body {
  margin:0;font-family:'Orbitron',sans-serif;color:#fff;
  overflow-x:hidden;background:#000;position:relative;
  cursor: none; /* éš±è—é è¨­æ»‘é¼ æ¸¸æ¨™ */
}
header{text-align:center;padding:60px 20px;}
h1{font-size:3em;color:#0ff;text-shadow:0 0 20px #0ff;animation:glow 3s ease-in-out infinite alternate;}
@keyframes glow{from{text-shadow:0 0 10px #0ff;} to{text-shadow:0 0 25px #ff3eff;}}
section{max-width:1000px;margin:auto;padding:40px 20px;}
h2{color:#ff3eff;margin-bottom:16px;}
#particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;background:#000;}

/* ===== æ»‘é¼ è·Ÿéš¨ç‰¹æ•ˆ ===== */
#cursor {
  position: fixed;
  width: 20px;
  height: 20px;
  border: 2px solid #0ff;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9999;
  transition: transform 0.1s ease;
  box-shadow: 0 0 20px #0ff, inset 0 0 10px #0ff;
}
#cursor-trail {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9998;
}
.rainbow-trail {
  position: fixed;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  pointer-events: none;
  z-index: 9997;
  animation: fadeOut 1s ease-out forwards;
}
@keyframes fadeOut {
  to { opacity: 0; transform: scale(2); }
}

.app-container{display:flex;flex-direction:column;gap:20px;}
.app-card{display:flex;align-items:center;gap:20px;background:rgba(255,255,255,0.05);border:1px solid #0ff3;border-radius:12px;padding:20px;transition:transform .3s, box-shadow .3s;position:relative;}
.app-card:hover{transform:translateY(-5px);box-shadow:0 0 25px #0ff;}
.app-image{width:120px;height:120px;border-radius:16px;object-fit:cover;}
.app-info h3{margin:0 0 8px 0;color:#0ff;}
.app-info p{color:#ccc;margin:0 0 10px 0;}
.button{display:inline-block;padding:8px 16px;border:1px solid #0ff;color:#0ff;border-radius:6px;text-decoration:none;transition:.2s;cursor:pointer;background:transparent;font-size:14px;}
.button:hover{background:#0ff;color:#000;transform:scale(1.05);}
.media-flex{display:flex;flex-wrap:wrap;gap:20px;}
.video-container{flex:2;min-width:300px;aspect-ratio:16/9;}
.spotify-container{flex:1;min-width:300px;}
.video-container iframe,.spotify-container iframe{width:100%;height:100%;border:none;border-radius:12px;}

/* è¼ªæ’­å®¹å™¨å’Œæ§åˆ¶æŒ‰éˆ• */
.slideshow-container{position:relative;width:100%;max-width:800px;margin:auto;}
.slide{display:none;width:100%;border-radius:12px;box-shadow:0 0 20px #0ff5;}
.slide-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,255,255,0.3);color:#0ff;border:2px solid #0ff;font-size:24px;padding:10px 15px;cursor:pointer;border-radius:6px;transition:all 0.3s;z-index:10;}
.slide-btn:hover{background:rgba(0,255,255,0.6);box-shadow:0 0 15px #0ff;}
.slide-btn.prev{left:10px;}
.slide-btn.next{right:10px;}
.dot{display:inline-block;width:12px;height:12px;margin:0 5px;background:#0ff3;border-radius:50%;cursor:pointer;transition:all 0.3s;}
.dot:hover,.dot.active{background:#0ff;box-shadow:0 0 10px #0ff;}

.ripple{position:fixed;border-radius:50%;pointer-events:none;border:2px solid #0ff;animation:ripple 0.6s ease-out;}
@keyframes ripple{from{transform:scale(0);opacity:0.8;} to{transform:scale(10);opacity:0;}}
#weather-quote{text-align:center;margin-top:10px;color:#aaf;font-size:1em;}

/* ===== è¶…ç´šå°è©±æ¡†æ¨£å¼ ===== */
#chatContainer {
  max-width: 800px;
  margin: 30px auto;
  background: rgba(0, 255, 255, 0.05);
  border: 2px solid #0ff;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
}
#chatHistory {
  height: 300px;
  overflow-y: auto;
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 12px;
  border: 1px solid #0ff3;
}
#chatHistory::-webkit-scrollbar {
  width: 8px;
}
#chatHistory::-webkit-scrollbar-track {
  background: rgba(0, 255, 255, 0.1);
  border-radius: 4px;
}
#chatHistory::-webkit-scrollbar-thumb {
  background: #0ff;
  border-radius: 4px;
}
.message {
  margin: 15px 0;
  display: flex;
  align-items: flex-start;
  animation: messageSlideIn 0.3s ease-out;
}
@keyframes messageSlideIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.message.user {
  justify-content: flex-end;
}
.message.ai {
  justify-content: flex-start;
}
.message-bubble {
  max-width: 70%;
  padding: 12px 16px;
  border-radius: 18px;
  position: relative;
  word-wrap: break-word;
}
.message.user .message-bubble {
  background: linear-gradient(135deg, #0ff, #00d4ff);
  color: #000;
  border-bottom-right-radius: 4px;
}
.message.ai .message-bubble {
  background: rgba(255, 62, 255, 0.2);
  border: 1px solid #ff3eff;
  color: #fff;
  border-bottom-left-radius: 4px;
}
.message-avatar {
  width: 35px;
  height: 35px;
  border-radius: 50%;
  margin: 0 10px;
  border: 2px solid #0ff;
  box-shadow: 0 0 10px #0ff;
}
.message.user .message-avatar {
  order: 2;
}
.typing-indicator {
  display: none;
  padding: 10px 16px;
}
.typing-indicator span {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #0ff;
  margin: 0 3px;
  animation: typing 1.4s infinite;
}
.typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
.typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
@keyframes typing {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-10px); }
}
#chatInputArea {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
#catInput {
  flex: 1;
  padding: 12px 16px;
  border-radius: 25px;
  border: 2px solid #0ff;
  background: rgba(0, 0, 0, 0.5);
  color: #0ff;
  font-size: 14px;
  outline: none;
  transition: all 0.3s;
}
#catInput:focus {
  box-shadow: 0 0 15px #0ff;
  background: rgba(0, 0, 0, 0.7);
}
#sendBtn {
  padding: 12px 24px;
  background: linear-gradient(135deg, #0ff, #00d4ff);
  border: none;
  border-radius: 25px;
  color: #000;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 14px;
}
#sendBtn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px #0ff;
}
#quickQuestions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 15px;
}
.quick-btn {
  padding: 6px 12px;
  background: rgba(0, 255, 255, 0.1);
  border: 1px solid #0ff;
  border-radius: 15px;
  color: #0ff;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.3s;
}
.quick-btn:hover {
  background: rgba(0, 255, 255, 0.3);
  transform: translateY(-2px);
}
#chatControls {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
#catMood {
  font-size: 12px;
  color: #0ff;
  display: flex;
  align-items: center;
  gap: 8px;
}
#moodIcon {
  font-size: 20px;
  animation: bounce 2s ease-in-out infinite;
}
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
#clearChat {
  padding: 6px 12px;
  background: rgba(255, 62, 255, 0.2);
  border: 1px solid #ff3eff;
  border-radius: 15px;
  color: #ff3eff;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.3s;
}
#clearChat:hover {
  background: rgba(255, 62, 255, 0.4);
}

/* éŠæˆ²æŒ‰éˆ• */
#gameBtn {
  position: fixed;
  top: 80px;
  right: 20px;
  z-index: 1000;
  padding: 12px 20px;
  background: linear-gradient(135deg, #ff3eff, #ff00aa);
  border: 2px solid #ff3eff;
  border-radius: 25px;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 8px;
  box-shadow: 0 0 20px rgba(255, 62, 255, 0.5);
}
#gameBtn:hover {
  transform: scale(1.1);
  box-shadow: 0 0 30px rgba(255, 62, 255, 0.8);
}
</style>
</head>
<body>
<!-- éŠæˆ²æŒ‰éˆ• -->
<a id="gameBtn" href="https://culaliya.github.io/SpaceGarden/" target="_blank">
  ğŸ® ç©éŠæˆ²
</a>

<canvas id="particles"></canvas>

<!-- è‡ªè¨‚æ»‘é¼ æ¸¸æ¨™ -->
<div id="cursor"></div>
<div id="cursor-trail"></div>

<header>
  <h1>ğŸŒŒ Culaliya's AI Art Diary ğŸŒŒ</h1>
  <p id="weather">ğŸŒ¤ï¸ è¼‰å…¥å¤©æ°£ä¸­...</p>
  <p id="weather-quote">âœ¨ æ­¡è¿ä¾†åˆ°è³½åšå®‡å®™ âœ¨</p>
</header>

<section>
  <h2>ğŸ¨ AI è—è¡“ç•«å»Šï¼ˆè‡ªå‹•è¼ªæ’­30å¼µåœ–ç‰‡ï¼‰</h2>
  <div class="slideshow-container">
    <button class="slide-btn prev" onclick="changeSlide(-1)">â®</button>
    <button class="slide-btn next" onclick="changeSlide(1)">â¯</button>
  </div>
  <div style="text-align:center;margin-top:15px;">
    <!-- Dots will be generated by JavaScript -->
  </div>
</section>

<section>
  <h2>ğŸ¬ å‰µä½œå½±ç‰‡</h2>
  <div class="media-flex">
    <div class="video-container">
      <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" allowfullscreen></iframe>
    </div>
    <div class="spotify-container">
      <iframe src="https://open.spotify.com/embed/track/3n3Ppam7vgaVa1iaRUc9Lp" allowfullscreen></iframe>
    </div>
  </div>
</section>

<section>
  <h2>ğŸ“± æˆ‘çš„ App åˆ—è¡¨</h2>
  <div id="app-container" class="app-container">è¼‰å…¥ä¸­...</div>
</section>

<section>
  <h2>ğŸŒŸ ä»Šæ—¥ NASA æ˜Ÿåœ–</h2>
  <div id="apod">è¼‰å…¥ä¸­...</div>
</section>

<section>
  <h2>ğŸ”® ç¥ç§˜å‘½ç†å åœ</h2>
  <label for="birthDate" style="color:#0ff;">è¼¸å…¥ä½ çš„ç”Ÿæ—¥ï¼š</label>
  <input type="date" id="birthDate" style="margin:10px 0;padding:8px;border:2px solid #0ff;border-radius:6px;background:#0003;color:#0ff;">
  <button class="button" onclick="getFortune()">é–‹å§‹å åœ</button>
  <div id="result" style="margin-top:20px;color:#ff3eff;"></div>
</section>

<!-- ===== è¶…ç´šå°è©±æ©Ÿå™¨äºº ===== -->
<section>
  <h2>ğŸ¤– èˆ‡å®‡å®™å–µæ˜Ÿäººå°è©±</h2>
  <div id="chatContainer">
    <div id="chatHistory">
      <div class="message ai">
        <img class="message-avatar" src="assets/blackcat.png" alt="Cat">
        <div class="message-bubble">
          å–µï½æˆ‘æ˜¯å®‡å®™å–µæ˜Ÿäººï¼æœ‰ä»€éº¼æƒ³èŠçš„å—ï¼Ÿ ğŸŒŒâœ¨
        </div>
      </div>
    </div>
    
    <div class="typing-indicator" id="typingIndicator">
      <span></span><span></span><span></span>
    </div>
    
    <div id="quickQuestions">
      <button class="quick-btn" onclick="askQuick('ä½ æœ€å–œæ­¡çš„æ˜Ÿçƒæ˜¯ä»€éº¼ï¼Ÿ')">ğŸª æœ€æ„›æ˜Ÿçƒ</button>
      <button class="quick-btn" onclick="askQuick('å‘Šè¨´æˆ‘ä¸€å€‹å®‡å®™å†·çŸ¥è­˜')">ğŸŒŒ å®‡å®™å†·çŸ¥è­˜</button>
      <button class="quick-btn" onclick="askQuick('ä»Šå¤©é©åˆåšä»€éº¼ï¼Ÿ')">âœ¨ ä»Šæ—¥å»ºè­°</button>
      <button class="quick-btn" onclick="askQuick('èªªå€‹ç¬‘è©±å§')">ğŸ˜¸ èªªç¬‘è©±</button>
    </div>
    
    <div id="chatInputArea">
      <input type="text" id="catInput" placeholder="è¼¸å…¥è¨Šæ¯..." onkeypress="handleEnter(event)">
      <button id="sendBtn" onclick="sendMessage()">ç™¼é€</button>
    </div>
    
    <div id="chatControls">
      <div id="catMood">
        <span id="moodIcon">ğŸ˜Š</span>
        <span id="moodText">å¿ƒæƒ…ï¼šæ„‰å¿«</span>
      </div>
      <button id="clearChat" onclick="clearChatHistory()">æ¸…é™¤å°è©±</button>
    </div>
  </div>
  
  <!-- å¯æ„›çš„è²“å’ªåœ–ç¤º -->
  <div style="text-align:center;margin-top:20px;">
    <img id="memeCat" src="assets/blackcat.png" alt="Meme Cat" 
         style="width:100px;cursor:pointer;transition:transform 0.3s;filter:drop-shadow(0 0 15px #0ff);">
  </div>
</section>

<!-- éŸ³æ•ˆ -->
<audio id="meow-sound" src="assets/meow.mp3" preload="auto"></audio>
<audio id="hover-sound" src="assets/hover.mp3" preload="auto"></audio>
<audio id="click-sound" src="assets/click.mp3" preload="auto"></audio>

<script>
// ===== æ»‘é¼ è·Ÿéš¨æ•ˆæœ =====
const cursor = document.getElementById('cursor');
const cursorTrail = document.getElementById('cursor-trail');
let mouseX = 0, mouseY = 0;
let trailX = 0, trailY = 0;

document.addEventListener('mousemove', (e) => {
  mouseX = e.clientX;
  mouseY = e.clientY;
  cursor.style.left = mouseX - 10 + 'px';
  cursor.style.top = mouseY - 10 + 'px';
  
  // å½©è™¹æ‹–å°¾æ•ˆæœ
  const trail = document.createElement('div');
  trail.className = 'rainbow-trail';
  trail.style.left = mouseX - 7.5 + 'px';
  trail.style.top = mouseY - 7.5 + 'px';
  trail.style.background = `hsl(${Date.now() % 360}, 100%, 60%)`;
  document.body.appendChild(trail);
  
  setTimeout(() => trail.remove(), 1000);
});

function animateTrail() {
  trailX += (mouseX - trailX) * 0.1;
  trailY += (mouseY - trailY) * 0.1;
  cursorTrail.style.left = trailX - 4 + 'px';
  cursorTrail.style.top = trailY - 4 + 'px';
  cursorTrail.style.background = `hsl(${Date.now() % 360}, 100%, 60%)`;
  requestAnimationFrame(animateTrail);
}
animateTrail();

// ===== è¶…ç´šå°è©±æ©Ÿå™¨äºº =====
const catInput = document.getElementById('catInput');
const chatHistory = document.getElementById('chatHistory');
const typingIndicator = document.getElementById('typingIndicator');
const memeCat = document.getElementById('memeCat');
const moodIcon = document.getElementById('moodIcon');
const moodText = document.getElementById('moodText');

let messageCount = 0;
const moods = {
  happy: { icon: 'ğŸ˜Š', text: 'æ„‰å¿«' },
  excited: { icon: 'ğŸ¤©', text: 'èˆˆå¥®' },
  thinking: { icon: 'ğŸ¤”', text: 'æ€è€ƒä¸­' },
  sleepy: { icon: 'ğŸ˜´', text: 'æƒ³ç¡' },
  playful: { icon: 'ğŸ˜¸', text: 'èª¿çš®' }
};

function updateMood(mood) {
  moodIcon.textContent = moods[mood].icon;
  moodText.textContent = 'å¿ƒæƒ…ï¼š' + moods[mood].text;
}

function typewriterEffect(text, element, speed = 30) {
  let i = 0;
  element.textContent = '';
  const interval = setInterval(() => {
    if (i < text.length) {
      element.textContent += text.charAt(i);
      i++;
      chatHistory.scrollTop = chatHistory.scrollHeight;
    } else {
      clearInterval(interval);
    }
  }, speed);
}

function addMessage(text, isUser = true) {
  const message = document.createElement('div');
  message.className = `message ${isUser ? 'user' : 'ai'}`;
  
  const avatar = document.createElement('img');
  avatar.className = 'message-avatar';
  avatar.src = isUser ? 'assets/user-avatar.png' : 'assets/blackcat.png';
  avatar.alt = isUser ? 'User' : 'Cat';
  
  const bubble = document.createElement('div');
  bubble.className = 'message-bubble';
  bubble.textContent = text;
  
  message.appendChild(avatar);
  message.appendChild(bubble);
  chatHistory.appendChild(message);
  chatHistory.scrollTop = chatHistory.scrollHeight;
}

async function sendMessage() {
  const text = catInput.value.trim();
  if (!text) return;
  
  addMessage(text, true);
  catInput.value = '';
  messageCount++;
  
  // æ ¹æ“šè¨Šæ¯æ•¸é‡æ›´æ–°å¿ƒæƒ…
  if (messageCount % 5 === 0) {
    const moodKeys = Object.keys(moods);
    updateMood(moodKeys[Math.floor(Math.random() * moodKeys.length)]);
  }
  
  typingIndicator.style.display = 'block';
  memeCat.style.transform = 'scale(1.1) rotate(-5deg)';
  
  try {
    // ä½¿ç”¨æœ¬åœ°å›æ‡‰ç³»çµ±ï¼ˆå› ç‚ºæ²’æœ‰å¯¦éš› APIï¼‰
    const responses = [
      'å–µï½é€™å€‹å•é¡Œå¾ˆæœ‰è¶£å‘¢ï¼ğŸŒŸ',
      'è®“æˆ‘æƒ³æƒ³... å—¯ï¼Œæˆ‘è¦ºå¾—é€™æ¨£å¦‚ä½•ï¼Ÿâœ¨',
      'å“‡ï¼ä½ çœŸæ˜¯å¤ªè°æ˜äº†ï¼ğŸ‰',
      'å–µå—šï½é€™è®“æˆ‘æƒ³èµ·äº†éŠ€æ²³ç³»çš„ç§˜å¯†... ğŸŒŒ',
      'æœ‰è¶£ï¼è®“æˆ‘å€‘ä¸€èµ·æ¢ç´¢å®‡å®™å§ï¼ğŸš€',
      'å–µå“ˆå“ˆï½ä½ èªªå¾—çœŸå¥½ï¼ğŸ˜¸',
      'é€™å€‹æƒ³æ³•è¶…é…·çš„ï¼ç¹¼çºŒèªªï¼ğŸ’«',
      'å–µï½æˆ‘å®Œå…¨åŒæ„ä½ çš„çœ‹æ³•ï¼ğŸŒˆ'
    ];
    
    await new Promise(resolve => setTimeout(resolve, 1500));
    typingIndicator.style.display = 'none';
    
    const reply = responses[Math.floor(Math.random() * responses.length)];
    
    const message = document.createElement('div');
    message.className = 'message ai';
    
    const avatar = document.createElement('img');
    avatar.className = 'message-avatar';
    avatar.src = 'assets/blackcat.png';
    avatar.alt = 'Cat';
    
    const bubble = document.createElement('div');
    bubble.className = 'message-bubble';
    
    message.appendChild(avatar);
    message.appendChild(bubble);
    chatHistory.appendChild(message);
    
    // æ‰“å­—æ©Ÿæ•ˆæœ
    typewriterEffect(reply, bubble);
    updateMood('happy');
    
  } catch (err) {
    typingIndicator.style.display = 'none';
    addMessage('å–µï¼Ÿç³»çµ±å‡ºéŒ¯äº†... ğŸ¾', false);
    console.error(err);
  } finally {
    memeCat.style.transform = 'scale(1) rotate(0deg)';
  }
}

function askQuick(question) {
  catInput.value = question;
  sendMessage();
}

function handleEnter(event) {
  if (event.key === 'Enter') {
    sendMessage();
  }
}

function clearChatHistory() {
  if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å°è©±è¨˜éŒ„å—ï¼Ÿ')) {
    chatHistory.innerHTML = `
      <div class="message ai">
        <img class="message-avatar" src="assets/blackcat.png" alt="Cat">
        <div class="message-bubble">
          å–µï½æˆ‘æ˜¯å®‡å®™å–µæ˜Ÿäººï¼æœ‰ä»€éº¼æƒ³èŠçš„å—ï¼Ÿ ğŸŒŒâœ¨
        </div>
      </div>
    `;
    messageCount = 0;
    updateMood('happy');
  }
}

// ===== è²“å’ªé»æ“Šæ•ˆæœ =====
const meowSound = document.getElementById('meow-sound');
memeCat.addEventListener('click', () => {
  meowSound.pause();
  meowSound.currentTime = 0;
  meowSound.volume = 0.2;
  meowSound.play();
  memeCat.style.transform = 'scale(1.2) rotate(10deg)';
  setTimeout(() => {
    memeCat.style.transform = 'scale(1) rotate(0deg)';
  }, 350);
});

// ===== ç²’å­èƒŒæ™¯ =====
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  particles = [];
  for (let i = 0; i < 80; i++) {
    particles.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.random() * 2 + 0.5,
      dx: (Math.random() - 0.5) * 0.5,
      dy: (Math.random() - 0.5) * 0.5,
      hue: Math.random() * 360
    });
  }
}

function drawParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles.forEach(p => {
    p.x += p.dx;
    p.y += p.dy;
    if (p.x < 0 || p.x > canvas.width) p.dx *= -1;
    if (p.y < 0 || p.y > canvas.height) p.dy *= -1;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
    ctx.fillStyle = `hsla(${p.hue},100%,65%,0.7)`;
    ctx.fill();
  });
  requestAnimationFrame(drawParticles);
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();
drawParticles();

// ===== è¼ªæ’­ï¼ˆä¿®æ”¹ç‚º30å¼µåœ–ç‰‡ï¼‰=====
let slideIndex = 0;
let slideTimer;

function showSlides() {
  const slides = document.querySelectorAll('.slide');
  const dots = document.querySelectorAll('.dot');
  
  slides.forEach((s, i) => s.style.display = i === slideIndex ? 'block' : 'none');
  dots.forEach((d, i) => d.classList.toggle('active', i === slideIndex));
  
  slideIndex = (slideIndex + 1) % slides.length;
  clearTimeout(slideTimer);
  slideTimer = setTimeout(showSlides, 3000);
}

function changeSlide(n) {
  const slides = document.querySelectorAll('.slide');
  slideIndex = (slideIndex + n + slides.length - 1) % slides.length;
  showSlides();
}

function currentSlide(n) {
  slideIndex = n;
  showSlides();
}

// ===== Load apps =====
async function loadApps() {
  const c = document.getElementById('app-container');
  try {
    const res = await fetch('data/apps.json');
    const apps = await res.json();
    c.innerHTML = '';
    apps.forEach(app => {
      const card = document.createElement('div');
      card.className = 'app-card';
      card.innerHTML = `
        <img class="app-image" src="${app.icon}">
        <div class="app-info">
          <h3>${app.name}</h3>
          <p>${app.desc}</p>
          <a class="button" href="${app.link}" target="_blank">App Store</a>
        </div>`;
      c.appendChild(card);
    });
    addHoverSounds();
  } catch {
    c.textContent = 'âš ï¸ ç„¡æ³•è¼‰å…¥ app è³‡æ–™';
  }
}
loadApps();

// ===== Fortune API =====
async function getFortune() {
  const date = document.getElementById('birthDate').value;
  if (!date) {
    alert('è«‹è¼¸å…¥ç”Ÿæ—¥');
    return;
  }
  const r = document.getElementById('result');
  try {
    const res = await fetch('https://raw.githubusercontent.com/Culaliya/ai-art-diary/main/data/fortune.json');
    const f = await res.json();
    r.innerHTML = `<h3>å‘½ç†çµæœå ±å‘Šï¼ˆä¾†è‡ª APIï¼‰</h3>
      <p>å¤©å¹²åœ°æ”¯ï¼š<strong>${f.stem}${f.branch}</strong></p>
      <p>ä¸»äº”è¡Œï¼š<strong>${f.element}</strong></p>
      <p>${f.msg}</p>`;
  } catch {
    r.textContent = 'âš ï¸ ç„¡æ³•è®€å– API è³‡æ–™';
  }
}

// ===== Hover sounds =====
function addHoverSounds() {
  const hoverSound = document.getElementById('hover-sound');
  hoverSound.volume = 0.2;
  document.querySelectorAll('.app-card,.button').forEach(el => {
    el.addEventListener('mouseenter', () => {
      hoverSound.currentTime = 0;
      hoverSound.play();
    });
  });
}

// ===== Click sound =====
document.addEventListener('click', e => {
  const clickSound = document.getElementById('click-sound');
  clickSound.volume = 0.2;
  clickSound.currentTime = 0;
  clickSound.play();
  const ripple = document.createElement('div');
  ripple.className = 'ripple';
  ripple.style.left = `${e.clientX}px`;
  ripple.style.top = `${e.clientY}px`;
  document.body.appendChild(ripple);
  ripple.addEventListener('animationend', () => ripple.remove());
});

// ===== Weather API =====
async function loadWeather() {
  const url = 'https://api.open-meteo.com/v1/forecast?latitude=24.8138&longitude=120.9675&current_weather=true';
  try {
    const res = await fetch(url);
    const data = await res.json();
    const w = data.current_weather;
    const codes = {
      0: 'æ™´æœ—', 1: 'ä¸»è¦æ™´æœ—', 2: 'éƒ¨åˆ†å¤šé›²', 3: 'å¤šé›²', 45: 'éœ§', 48: 'éœ§å‡‡',
      51: 'ç´°é›¨', 53: 'ä¸­é›¨', 55: 'å¤§é›¨', 61: 'å°é›¨', 63: 'ä¸­é›¨', 65: 'å¤§é›¨',
      71: 'å°é›ª', 73: 'ä¸­é›ª', 75: 'å¤§é›ª', 80: 'é™£é›¨', 81: 'ä¸­é™£é›¨', 82: 'æš´é›¨'
    };
    const weatherText = codes[w.weathercode] || 'æœªçŸ¥';
    document.getElementById('weather').innerText = `æ–°ç«¹ ${w.temperature}Â°Cï¼Œ${weatherText}`;
  } catch {
    document.getElementById('weather').innerText = 'å¤©æ°£è¼‰å…¥å¤±æ•—';
  }
}
loadWeather();

// ===== NASA APOD =====
async function loadApod() {
  const apodDiv = document.getElementById('apod');
  try {
    const res = await fetch('https://api.nasa.gov/planetary/apod?api_key=QCUm1wVbVLFqsiNJdaTKolWUuXTo4Qdxjc1zF4f3');
    const data = await res.json();
    
    if (data.media_type === 'image') {
      apodDiv.innerHTML = `
        <img src="${data.url}" alt="${data.title}" 
             style="max-width:100%;border-radius:12px;box-shadow:0 0 20px #0ff5;">
        <p style="margin-top:15px;color:#aaf;font-size:1.2em;font-weight:bold;">${data.title}</p>
        <p style="color:#ccc;font-size:0.95em;margin-top:10px;line-height:1.6;">${data.explanation}</p>
        <p style="color:#888;font-size:0.85em;margin-top:10px;">ğŸ“… ${data.date}</p>
      `;
    } else if (data.media_type === 'video') {
      apodDiv.innerHTML = `
        <iframe src="${data.url}" frameborder="0" allowfullscreen 
                style="width:100%;height:400px;border-radius:12px;box-shadow:0 0 20px #0ff5;"></iframe>
        <p style="margin-top:15px;color:#aaf;font-size:1.2em;font-weight:bold;">${data.title}</p>
        <p style="color:#ccc;font-size:0.95em;margin-top:10px;line-height:1.6;">${data.explanation}</p>
        <p style="color:#888;font-size:0.85em;margin-top:10px;">ğŸ“… ${data.date}</p>
      `;
    }
  } catch (err) {
    console.error('NASA APOD error:', err);
    apodDiv.innerText = 'NASA æ˜Ÿåœ–è¼‰å…¥å¤±æ•—';
  }
}
loadApod();

// ===== å‹•æ…‹ç”Ÿæˆ30å¼µåœ–ç‰‡è¼ªæ’­ =====
document.addEventListener('DOMContentLoaded', function() {
  const galleryContainer = document.querySelector('.slideshow-container');
  if (!galleryContainer) return;
  
  // æ‰¾åˆ°åœ–ç‰‡é»é»å®¹å™¨
  let dotsContainer = galleryContainer.nextElementSibling;
  
  // ç§»é™¤æŒ‰éˆ•ï¼Œä¿ç•™å®ƒå€‘
  const prevBtn = galleryContainer.querySelector('.prev');
  const nextBtn = galleryContainer.querySelector('.next');
  
  // æ¸…ç©ºå®¹å™¨ï¼ˆä½†ä¿ç•™æŒ‰éˆ•ï¼‰
  galleryContainer.innerHTML = '';
  if (dotsContainer) dotsContainer.innerHTML = '';
  
  // é‡æ–°åŠ å…¥æŒ‰éˆ•
  if (prevBtn) galleryContainer.appendChild(prevBtn);
  if (nextBtn) galleryContainer.appendChild(nextBtn);
  
  // ç”Ÿæˆ30å¼µåœ–ç‰‡
  const totalImages = 30;
  for (let i = 1; i <= totalImages; i++) {
    const img = document.createElement('img');
    img.className = 'slide';
    img.src = `assets/midjourney/mid${i}.jpg`;
    img.alt = `AI è—è¡“ä½œå“ ${i}`;
    
    // å°‡åœ–ç‰‡æ’å…¥åˆ°æŒ‰éˆ•ä¹‹å‰
    if (nextBtn) {
      galleryContainer.insertBefore(img, nextBtn);
    } else {
      galleryContainer.appendChild(img);
    }
    
    // ç”Ÿæˆå°æ‡‰çš„é»é»
    if (dotsContainer) {
      const dot = document.createElement('span');
      dot.className = 'dot';
      dot.addEventListener('click', () => currentSlide(i - 1));
      dotsContainer.appendChild(dot);
    }
  }
  
  // å•Ÿå‹•è¼ªæ’­
  showSlides();
});
</script>
</body>
</html>
