<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>🌟 星座性格分析 | Culaliya’s Mystic Lab</title>
<style>
  :root{
    --bg1:#080b16; --bg2:#0b0d20; --orb1:#ff3eff; --orb2:#00e0ff;
    --cyan:#00ffff; --pink:#ff3eff; --white:#eaf6ff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:'Orbitron',system-ui,-apple-system,'PingFang TC','Microsoft JhengHei',sans-serif;
    background:radial-gradient(circle at 50% 20%, var(--bg1) 0%, var(--bg2) 70%, #000 100%);
    color:#0ff; text-align:center; overflow-x:hidden; padding:16px;
  }
  h1{
    margin:50px 0 10px; font-size:2em; color:#ffd9ff;
    text-shadow:0 0 25px var(--pink), 0 0 40px var(--cyan);
    animation:glowPulse 3s infinite alternate;
  }
  @keyframes glowPulse { from{ text-shadow:0 0 15px var(--pink);} to{ text-shadow:0 0 35px var(--cyan),0 0 60px var(--pink);} }

  /* 背景霓虹光球 */
  .neon-orb{position:absolute;border-radius:50%;filter:blur(80px);opacity:.4;animation:float 12s infinite ease-in-out alternate;z-index:0}
  .orb1{width:420px;height:420px;background:var(--orb1);top:8%;left:8%}
  .orb2{width:520px;height:520px;background:var(--orb2);bottom:8%;right:10%;animation-delay:3s}
  @keyframes float{0%{transform:translateY(0)}100%{transform:translateY(-60px) translateX(30px)}}

  .content{position:relative;z-index:1;max-width:1100px;margin:0 auto}

  /* 控制面板 */
  .panel{
    margin:18px auto 10px; padding:16px;
    background:linear-gradient(180deg,rgba(12,18,40,.85),rgba(8,12,25,.85));
    border:1px solid rgba(255,255,255,.12); border-radius:16px;
    box-shadow:0 0 22px rgba(0,255,255,.25);
  }
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;align-items:end}
  .group label{display:block;color:#aee; font-size:.9em; margin:0 0 6px 4px}
  .group input,.group select{
    width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12);
    background:rgba(10,16,30,.9); color:var(--white); outline:none;
  }
  .btn{
    padding:11px 16px; border-radius:12px; border:1px solid #00f0ff;
    background:linear-gradient(180deg,#11384f,#0b2536); color:#bdf9ff; font-weight:700; cursor:pointer;
    transition:.2s; box-shadow:0 0 18px rgba(0,255,255,.25)
  }
  .btn:hover{transform:translateY(-1px); box-shadow:0 0 28px rgba(0,255,255,.45)}

  /* 卡片區（結果） */
  .cards{display:grid; grid-template-columns:repeat(3,1fr); gap:16px; margin:18px 0}
  .card{
    min-height:180px; padding:16px; border-radius:16px;
    background:rgba(255,255,255,0.05); border:2px solid #0ff;
    box-shadow:0 0 18px rgba(0,255,255,.3);
    transition:.35s; animation:glowFlow 4s infinite;
    text-align:left;
  }
  .card:hover{transform:translateY(-8px) scale(1.02); box-shadow:0 0 35px #ff3eff, 0 0 50px #0ff}
  @keyframes glowFlow {0%{border-color:#0ff;box-shadow:0 0 10px #0ff}50%{border-color:#ff3eff;box-shadow:0 0 20px #ff3eff}100%{border-color:#0ff;box-shadow:0 0 10px #0ff}}
  .title{display:flex;align-items:center;gap:8px;font-size:1.1em;color:#fff;margin-bottom:10px}
  .badge{display:inline-block;padding:2px 8px;border-radius:999px;background:linear-gradient(135deg,#00ffff,#ff3eff);color:#000;font-weight:800;font-size:.75em;box-shadow:0 0 8px #0ff}

  .kv{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;margin:10px 0 4px}
  .kv .chip{border:1px solid rgba(255,255,255,.12);border-radius:999px;padding:6px 10px;color:#cfe}

  /* 返回 */
  .back{display:inline-block;margin:10px auto 24px;padding:10px 18px;border:2px solid #0ff;border-radius:20px;
    color:#0ff;text-decoration:none;background:rgba(0,255,255,.12);transition:.2s}
  .back:hover{background:rgba(0,255,255,.28)}
  @media (max-width:900px){ .grid{grid-template-columns:1fr 1fr 1fr} .cards{grid-template-columns:1fr} }
  @media (max-width:640px){ .grid{grid-template-columns:1fr 1fr;gap:10px} .cards{grid-template-columns:1fr} }
</style>
</head>
<body>
  <div class="neon-orb orb1"></div>
  <div class="neon-orb orb2"></div>

  <div class="content">
    <h1>🌟 星座性格分析</h1>

    <div class="panel">
      <div class="grid">
        <div class="group">
          <label>生日（陽曆）</label>
          <input type="date" id="birthDate" />
        </div>
        <div class="group">
          <label>出生時間（可選，用於備註）</label>
          <input type="time" id="birthTime" />
        </div>
        <div class="group">
          <button id="btnGo" class="btn">✨ 生成分析</button>
        </div>
      </div>
    </div>

    <div id="result" style="display:none;">
      <div class="kv" id="headline"></div>
      <div class="cards">
        <div class="card">
          <div class="title">🧭 太陽星座 <span id="sunBadge" class="badge">NEW</span></div>
          <div id="sunText">—</div>
        </div>
        <div class="card">
          <div class="title">💖 情感需求（建議的相處節奏）</div>
          <div id="needsText">—</div>
        </div>
        <div class="card">
          <div class="title">👀 第一印象（你給人的外觀氣場）</div>
          <div id="firstImpression">—</div>
        </div>
      </div>
    </div>

    <a class="back" href="../fortune_lab.html">🏠 回命理實驗室</a>
  </div>

<script>
/* ---------- 太陽星座計算（Tropical） ----------
   使用固定的常用界線；若生日在邊界日，採一般通用區間（不含天文年變動）。*/
const SUN_RANGES = [
  {name:'牡羊座',start:'03-21',end:'04-19',emoji:'♈'},
  {name:'金牛座',start:'04-20',end:'05-20',emoji:'♉'},
  {name:'雙子座',start:'05-21',end:'06-20',emoji:'♊'},
  {name:'巨蟹座',start:'06-21',end:'07-22',emoji:'♋'},
  {name:'獅子座',start:'07-23',end:'08-22',emoji:'♌'},
  {name:'處女座',start:'08-23',end:'09-22',emoji:'♍'},
  {name:'天秤座',start:'09-23',end:'10-22',emoji:'♎'},
  {name:'天蠍座',start:'10-23',end:'11-21',emoji:'♏'},
  {name:'射手座',start:'11-22',end:'12-21',emoji:'♐'},
  // 摩羯跨年：12/22~12/31 或 01/01~01/19
  {name:'摩羯座',start:'12-22',end:'12-31',emoji:'♑',split2:{start:'01-01',end:'01-19'}},
  {name:'水瓶座',start:'01-20',end:'02-18',emoji:'♒'},
  {name:'雙魚座',start:'02-19',end:'03-20',emoji:'♓'},
];

function inRange(mmdd, a, b){
  return mmdd >= a && mmdd <= b;
}
function getSunSign(dateStr){
  // dateStr = "YYYY-MM-DD"
  const [Y,M,D] = dateStr.split('-').map(v=>parseInt(v,10));
  if (isNaN(Y) || isNaN(M) || isNaN(D)) return null;
  const mmdd = `${String(M).padStart(2,'0')}-${String(D).padStart(2,'0')}`;
  for(const r of SUN_RANGES){
    if (r.split2){
      if (inRange(mmdd, r.start, r.end) || inRange(mmdd, r.split2.start, r.split2.end)) return r;
    } else if (inRange(mmdd, r.start, r.end)) {
      return r;
    }
  }
  return null;
}

/* ---------- 文案庫 ---------- */
const SUN_TRAITS = {
 '牡羊座':'主動果決、直球溝通；討厭等待，行動就是你的語言。',
 '金牛座':'務實穩定、感官敏銳；討厭被催促，重視質感與安全感。',
 '雙子座':'好奇靈活、社交迅速；需要多變與新鮮，腦內 always online。',
 '巨蟹座':'溫柔顧家、情感細膩；安全感來源於被重視與被需要。',
 '獅子座':'自信陽光、熱情大方；在舞台上最發光，需要被肯定。',
 '處女座':'細節控、秩序控；喜歡可預期與可改善的環境與人事物。',
 '天秤座':'審美在線、溫和平衡；善於協調，需要和諧的人際氛圍。',
 '天蠍座':'深情專注、直覺敏銳；重視信任，不輕易投入但一旦投入很深。',
 '射手座':'自由冒險、宏觀樂觀；需要空間與遠方，討厭被綁住。',
 '摩羯座':'責任感強、持久耐力；以結果導向來愛與工作，抗壓穩定。',
 '水瓶座':'理性獨立、前衛創新；需要自由思考的空間與志同道合的夥伴。',
 '雙魚座':'浪漫感性、共情力高；需要被理解與保護想像的柔軟。'
};
const EMOTIONAL_NEEDS = {
 '牡羊座':'被肯定與快速回應；共同參與挑戰能加深連結。',
 '金牛座':'有規律的陪伴與實際的體貼；不要頻繁變動。',
 '雙子座':'日常新鮮話題、一起學習/出遊；避免封閉與重複。',
 '巨蟹座':'安心的私人空間與穩定承諾；慢慢來最真。',
 '獅子座':'讚賞與光彩時刻；一起慶祝彼此的成就。',
 '處女座':'界線清楚、務實協作；欣賞細節與努力本身。',
 '天秤座':'共享美感與公平對話；重視儀式感與人際平衡。',
 '天蠍座':'深度信任與情緒誠實；避免曖昧不明的承諾。',
 '射手座':'自由與共同目標的遠方；允許即興與探索。',
 '摩羯座':'長期計畫、具體里程碑；以行動表達愛與支持。',
 '水瓶座':'思想連結與個人空間；尊重獨特節奏與社群價值。',
 '雙魚座':'情感共鳴與溫柔氛圍；用故事/音樂/夢想交流。'
};
const FIRST_IMPRESSION = {
 '牡羊座':'爽快直接、有領頭氣場；行動力令人安心。',
 '金牛座':'穩重可靠、品味出眾；給人值得托付的感覺。',
 '雙子座':'靈巧健談、節奏明快；無形成為場上的訊息樞紐。',
 '巨蟹座':'溫暖體貼、情緒收納者；像家一樣令人放鬆。',
 '獅子座':'亮眼大方、舞台體質；陽光自信很會帶氣氛。',
 '處女座':'專注高標、條理分明；細節與效率就是魅力。',
 '天秤座':'優雅合群、審美一流；旁人願意主動靠近。',
 '天蠍座':'神秘專注、目光銳利；氣場強烈但很真。',
 '射手座':'樂觀灑脫、直來直往；讓人想到旅程與遠方。',
 '摩羯座':'沉著務實、抗壓可靠；默默扛起進度的人。',
 '水瓶座':'清醒獨立、點子怪美；總能帶來非典型解法。',
 '雙魚座':'柔軟浪漫、共感力強；容易讓人卸下防備。'
};

/* ---------- 事件 ---------- */
const dEl = document.getElementById('birthDate');
const tEl = document.getElementById('birthTime');
const rEl = document.getElementById('result');
const hEl = document.getElementById('headline');
const sunText = document.getElementById('sunText');
const needsText = document.getElementById('needsText');
const firstImpression = document.getElementById('firstImpression');
const sunBadge = document.getElementById('sunBadge');

document.getElementById('btnGo').addEventListener('click', ()=>{
  const dateStr = dEl.value;
  if(!dateStr){ alert('請先選擇生日（陽曆）'); return; }
  const info = getSunSign(dateStr);
  if(!info){ alert('日期格式有誤，請重選。'); return; }

  // 標題列
  hEl.innerHTML = `
    <span class="chip">生日：${dateStr}${tEl.value ? ' '+tEl.value : ''}</span>
    <span class="chip">太陽：${info.emoji} ${info.name}</span>
  `;

  // 內容
  sunText.textContent   = SUN_TRAITS[info.name] || '—';
  needsText.textContent = EMOTIONAL_NEEDS[info.name] || '—';
  firstImpression.textContent = FIRST_IMPRESSION[info.name] || '—';

  // NEW 標籤：當天第一次計算時短暫顯示
  sunBadge.style.display = 'inline-block';
  setTimeout(()=> sunBadge.style.display = 'none', 1800);

  rEl.style.display = 'block';
  rEl.scrollIntoView({behavior:'smooth', block:'start'});
});

/* 預設日期時間（使用使用者本機時間） */
(function setDefault(){
  const now = new Date();
  const y = now.getFullYear();
  const m = String(now.getMonth()+1).padStart(2,'0');
  const d = String(now.getDate()).padStart(2,'0');
  const hh = String(now.getHours()).padStart(2,'0');
  const mm = String(now.getMinutes()).padStart(2,'0');
  dEl.value = `${y}-${m}-${d}`;
  tEl.value = `${hh}:${mm}`;
})();
</script>
</body>
</html>
