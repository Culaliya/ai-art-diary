<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒŒ æ˜Ÿåº§å‘½ç›¤æ’ç›¤å·¥å…· v3.0 | Culaliya Mystic Lab</title>

<style>
body {
  margin: 0;
  font-family: 'Noto Sans TC', sans-serif;
  background: radial-gradient(circle at 50% 20%, #0a0820 0%, #120a2f 70%, #000 100%);
  color: #fff;
  text-align: center;
  min-height: 100vh;
  overflow-x: hidden;
}

h1 {
  font-size: 2.2em;
  margin-top: 40px;
  color: #ffd700;
  text-shadow: 0 0 20px #ffb347, 0 0 40px #ffd700;
}

.container {
  width: min(90%, 700px);
  margin: 40px auto;
  padding: 30px;
  background: rgba(20, 10, 40, 0.85);
  border: 1px solid rgba(255, 215, 0, 0.3);
  border-radius: 18px;
  box-shadow: 0 0 40px rgba(255, 215, 0, 0.25);
  backdrop-filter: blur(8px);
}

label {
  display: block;
  margin: 15px 0 5px;
  font-size: 1.1em;
  color: #ffd700;
}

input, button {
  width: 90%;
  max-width: 400px;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #ffb347;
  font-size: 1em;
  background: rgba(255, 255, 255, 0.05);
  color: #fff;
  margin-bottom: 10px;
}

button {
  cursor: pointer;
  background: linear-gradient(45deg, #5a2ad8, #8a4af8);
  border: none;
  color: #fff;
  font-weight: bold;
  transition: all 0.3s;
  box-shadow: 0 0 20px rgba(106, 42, 216, 0.4);
}
button:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 35px rgba(255, 215, 0, 0.7);
}

.results {
  margin-top: 30px;
  display: none;
}

.result-card {
  background: linear-gradient(135deg, rgba(70, 26, 141, 0.9), rgba(106, 42, 216, 0.9));
  border: 1px solid rgba(255, 215, 0, 0.4);
  border-radius: 12px;
  padding: 20px;
  margin: 10px auto;
  width: 85%;
  max-width: 400px;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.4);
  transition: all 0.3s;
}
.result-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
}
.result-card h3 {
  color: #ffd700;
  margin-bottom: 8px;
}
.result-card p {
  color: #e0d7ff;
  font-size: 0.95em;
}

.back-link {
  display: inline-block;
  margin-top: 40px;
  color: #0ff;
  text-decoration: none;
  border: 1px solid #0ff;
  border-radius: 10px;
  padding: 10px 20px;
  transition: 0.3s;
}
.back-link:hover {
  background: rgba(0,255,255,0.2);
}
</style>
</head>

<body>
<h1>ğŸŒŒ æ˜Ÿåº§å‘½ç›¤æ’ç›¤å·¥å…· v3.0</h1>
<div class="container">
  <label for="birthDate">å‡ºç”Ÿæ—¥æœŸ</label>
  <input type="date" id="birthDate">

  <label for="birthTime">å‡ºç”Ÿæ™‚é–“</label>
  <input type="time" id="birthTime">

  <label for="birthPlace">å‡ºç”Ÿåœ°é»ï¼ˆåŸå¸‚ï¼‰</label>
  <input type="text" id="birthPlace" placeholder="ä¾‹å¦‚ï¼šTaipei">

  <button id="generateBtn">âœ¨ ç”Ÿæˆå‘½ç›¤</button>

  <div class="results" id="results"></div>

  <a href="../fortune_lab.html" class="back-link">ğŸ  å›å‘½ç†å¯¦é©—å®¤</a>
</div>

<script>
// æ˜Ÿåº§è³‡æ–™è¡¨
const signs = [
  "ç‰¡ç¾Šåº§","é‡‘ç‰›åº§","é›™å­åº§","å·¨èŸ¹åº§","ç…å­åº§","è™•å¥³åº§",
  "å¤©ç§¤åº§","å¤©è åº§","å°„æ‰‹åº§","æ‘©ç¾¯åº§","æ°´ç“¶åº§","é›™é­šåº§"
];

// API: https://api.astrologyapi.com/v1/sun_sign_prediction æˆ– https://aztro.sameerkumar.website
async function fetchZodiacData(date, time, place) {
  // æ¨¡æ“¬ç”¨ APIï¼Œå¯æ›¿æ›ç‚ºå¯¦éš›å‡ºç”Ÿåœ°å‘½ç›¤ API
  const birth = new Date(`${date}T${time || "12:00"}`);
  const month = birth.getMonth() + 1;
  const day = birth.getDate();
  const sign = calculateZodiac(month, day);
  
  // æ¨¡æ“¬å¤ªé™½/æœˆäº®/ä¸Šå‡
  return {
    sun: sign,
    moon: signs[(signs.indexOf(sign) + 2) % 12],
    rising: signs[(signs.indexOf(sign) + 4) % 12],
    desc: getZodiacDescription(sign)
  };
}

// è¨ˆç®—å¤ªé™½æ˜Ÿåº§
function calculateZodiac(month, day) {
  const zodiacRanges = [
    [3,21,4,19,"ç‰¡ç¾Šåº§"], [4,20,5,20,"é‡‘ç‰›åº§"], [5,21,6,20,"é›™å­åº§"], [6,21,7,22,"å·¨èŸ¹åº§"],
    [7,23,8,22,"ç…å­åº§"], [8,23,9,22,"è™•å¥³åº§"], [9,23,10,22,"å¤©ç§¤åº§"], [10,23,11,21,"å¤©è åº§"],
    [11,22,12,21,"å°„æ‰‹åº§"], [12,22,1,19,"æ‘©ç¾¯åº§"], [1,20,2,18,"æ°´ç“¶åº§"], [2,19,3,20,"é›™é­šåº§"]
  ];
  for (let [sm, sd, em, ed, sign] of zodiacRanges) {
    if ((month === sm && day >= sd) || (month === em && day <= ed)) return sign;
  }
  return "æœªçŸ¥";
}

// æ˜Ÿåº§ç°¡ä»‹
function getZodiacDescription(sign) {
  const desc = {
    "ç‰¡ç¾Šåº§": "ç†±æƒ…ç›´æ¥ã€è¡Œå‹•æ´¾ï¼Œé©åˆä¸»å‹•å‡ºæ“Šçš„èˆå°ã€‚",
    "é‡‘ç‰›åº§": "è…³è¸å¯¦åœ°ã€é‡è¦–æ„Ÿå®˜äº«å—ï¼Œç©©å®šæ˜¯ä½ çš„åŠ›é‡ã€‚",
    "é›™å­åº§": "è°æ˜éˆæ´»ï¼Œèªè¨€æ˜¯ä½ çš„é­”æ³•ã€‚",
    "å·¨èŸ¹åº§": "æº«æŸ”æ•æ„Ÿï¼Œæƒ…æ„Ÿæ˜¯ä½ çš„æŒ‡å—é‡ã€‚",
    "ç…å­åº§": "è‡ªä¿¡è€Œç†±æƒ…ï¼Œå¤©ç”Ÿçš„èˆå°ä¹‹ç‹ã€‚",
    "è™•å¥³åº§": "ç†æ€§ç´°è†©ï¼Œå®Œç¾ä¸»ç¾©æ˜¯ä½ çš„è—è¡“ã€‚",
    "å¤©ç§¤åº§": "å„ªé›…æœ‰å“å‘³ï¼Œå¹³è¡¡èˆ‡ç¾æ„Ÿæ˜¯ä½ çš„ä¿¡ä»°ã€‚",
    "å¤©è åº§": "æ·±æ²‰ç¥ç§˜ï¼Œæƒ…æ„Ÿçš„åŠ›é‡ç„¡å¯åŒ¹æ•µã€‚",
    "å°„æ‰‹åº§": "è‡ªç”±å¥”æ”¾ï¼Œè¿½æ±‚çœŸç†èˆ‡é æ–¹ã€‚",
    "æ‘©ç¾¯åº§": "å¯¦éš›ç©©é‡ï¼Œé‡å¿ƒèˆ‡è²¬ä»»ä¸¦è¡Œã€‚",
    "æ°´ç“¶åº§": "å‰è¡›ç¨ç«‹ï¼Œæ€è€ƒæœªä¾†çš„é©å‘½å®¶ã€‚",
    "é›™é­šåº§": "æµªæ¼«å¤¢å¹»ï¼Œæ„Ÿå—èˆ‡éˆæ€§è¶…è¶Šç•Œç·šã€‚"
  };
  return desc[sign] || "ä½ æ˜¯å®‡å®™ä¸­ç¨ä¸€ç„¡äºŒçš„éˆé­‚ã€‚";
}

document.getElementById("generateBtn").addEventListener("click", async () => {
  const date = document.getElementById("birthDate").value;
  const time = document.getElementById("birthTime").value;
  const place = document.getElementById("birthPlace").value || "æœªçŸ¥åœ°é»";

  if (!date) {
    alert("è«‹è¼¸å…¥å®Œæ•´å‡ºç”Ÿæ—¥æœŸï¼");
    return;
  }

  const resultDiv = document.getElementById("results");
  resultDiv.style.display = "block";
  resultDiv.innerHTML = "<p>â³ æ­£åœ¨ç”Ÿæˆå‘½ç›¤...</p>";

  try {
    const data = await fetchZodiacData(date, time, place);
    resultDiv.innerHTML = `
      <div class="result-card sun">
        <h3>â˜€ï¸ å¤ªé™½æ˜Ÿåº§</h3>
        <p>${data.sun}</p>
        <p>${data.desc}</p>
      </div>
      <div class="result-card moon">
        <h3>ğŸŒ™ æœˆäº®æ˜Ÿåº§</h3>
        <p>${data.moon}</p>
        <p>æƒ…æ„Ÿè¡¨é”çš„æ ¸å¿ƒï¼Œåæ˜ ä½ å…§åœ¨çš„æƒ…ç·’ç¯€å¥ã€‚</p>
      </div>
      <div class="result-card earth">
        <h3>â¬†ï¸ ä¸Šå‡æ˜Ÿåº§</h3>
        <p>${data.rising}</p>
        <p>ä½ åœ¨ä»–äººçœ¼ä¸­çš„å°è±¡ï¼Œæ˜¯äººç”Ÿçš„èµ·é»èƒ½é‡ã€‚</p>
      </div>
    `;
  } catch (err) {
    resultDiv.innerHTML = `<p style="color:red;">âš ï¸ å‘½ç›¤ç”Ÿæˆå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>`;
    console.error(err);
  }
});
</script>
</body>
</html>
